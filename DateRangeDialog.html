<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sanchez&display=swap" rel="stylesheet">

    <style>
      body {
        font-family: 'Sanchez', sans-serif;
        background-color: #ffffff;
        padding: 1rem;
      }
      h3 {
        color: #000000;
        font-weight: bold;
        text-align: center;
        margin-bottom: 1.5rem;
      }
      .form-group {
        margin-bottom: 1rem;
      }
      label {
        display: block;
        margin-bottom: 0.5rem;
        color: #000000;
      }
      input[type="date"] {
        width: 100%;
        padding: 8px;
        border: 1px solid #cccccc;
        border-radius: 4px;
        box-sizing: border-box; /* Ensures padding doesn't affect width */
        font-family: 'Sanchez', sans-serif;
      }
      button {
        width: 100%;
        padding: 10px;
        background-color: #d9534f; /* A touch of red */
        color: white;
        font-family: 'Sanchez', sans-serif;
        font-size: 16px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }
      button:hover {
        opacity: 0.9;
      }
    </style>
  </head>
  <body>
    <h3>Payment Report</h3>
    
    <div class="form-group">
      <label for="startDate">Start Date</label>
      <input type="date" id="startDate">
    </div>

    <div class="form-group">
      <label for="endDate">End Date</label>
      <input type="date" id="endDate">
    </div>

    <button onclick="submitDates()">Generate Report</button>

    <script>
      function submitDates() {
        var dateObject = {
          start: document.getElementById('startDate').value,
          end: document.getElementById('endDate').value
        };
        google.script.run
          .withSuccessHandler(closeDialog)
          .withFailureHandler(showError)
          .processPaymentReport(dateObject);
      }

      function closeDialog() {
        google.script.host.close();
      }
      
      function showError(error) {
        alert('Error: ' + error.message);
        closeDialog();
      }
    </script>
  </body>
</html>